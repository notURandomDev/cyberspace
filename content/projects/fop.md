# 软件开发实践 2

- 授课教师：吴以凡
- 时间：2024.08.27 - 2024.09.05
- 文档撰写者：22050208 - 黄子烨

## 1. 项目总览

### 1.1. 项目选题

在本次短学期下发任务的安排来看，我们需要从老师提供9个题目中选出一个，作为将要完成的项目；而从人员分配上来看，我们团队有5个人，每个人都分配到了不同的任务：

| 具体项目名称         |
| -------------------- |
| 团队任务协作系统     |
| 在线题库与组卷系统   |
| 在线学习平台         |
| 校园二手交易系统     |
| 设施报修管理系统     |
| 宠物信息交流平台     |
| 旅游管理系统         |
| 在线招聘系统         |
| AI驱动的客户支持系统 |

| 开发人员 | 具体任务                     |
| -------- | ---------------------------- |
| 楼乐天   | 项目经理、测试人员、文档撰写 |
| 吴佳哲   | 前端开发（PC端）             |
| 黄子烨   | 前端开发（移动端）           |
| 王浩屾   | 后端开发（DBA + API接口）    |
| 谢天赐   | 后端开发（API接口）          |

在综合考虑项目开发时间周期、项目开发难度、开发人员分配之后；我们小组选择了业务流程门槛较低的【宠物信息交流平台】

而我们小组，则取了一个有趣的名字 -【418TEAPOTS】

![From mdn web docs - Web Dev should be fun!](https://prod-files-secure.s3.us-west-2.amazonaws.com/120bd56a-ca1a-44ba-bfb9-f475c03d33ed/a4d5e1f0-0edf-4bd3-a953-c73f74229dfd/image.png)

From mdn web docs - Web Dev should be fun!

### 1.2. 项目周期（为期10天）

![lQLPKH7nXjGmzdPNAkzNBSCw4fZXUu3PJeAGtebNTP72AA_1312_588.png](https://prod-files-secure.s3.us-west-2.amazonaws.com/120bd56a-ca1a-44ba-bfb9-f475c03d33ed/15bdb3c1-fa9b-43e0-8332-c752243307b3/lQLPKH7nXjGmzdPNAkzNBSCw4fZXUu3PJeAGtebNTP72AA_1312_588.png)

期间，上课为上午 08:05 - 11:50；虽然每天都是早八，但是这个上课时间对于项目的开发是有利的，因为早八能迫使我早起，从而一天能有更多的时间投入该项目（如果没有早八可能就会迟了一两个小时起床，而我晚上睡觉的时间基本相同，于是一天中能够利用的时间就多了这一两个小时）

### 1.3. 主要目标

- 移动端（我负责的内容）
  - 社区主页：能够刷帖子
  - 帖子详情：能够看到帖子的详情内容
    - 评论区：新增评论、删除评论
  - 新增帖子：用户信息、正文、图片、详情项（根据帖子类型的变化而变化）
  - 个人主页
    - 用户信息：用户昵称、联系方式、头像（可更改）、个人简介
    - 个人动态：用户自己发过的帖子（可删除）
    - 宠物画廊：图片+标题，用于展示用户的宠物照片
- PC端（管理员界面，可以对帖子、用户、评论三个实体进行管理）

## 2. 使用到的技术

### 2.1. 前端技术

|          | 移动端                 | PC端       |
| -------- | ---------------------- | ---------- |
| 框架     | Vue3                   | React.js   |
| UI组件库 | Vuetify + Element Plus | Ant Design |

### 2.2. 后端技术

- 数据库：SQL Sever
- 框架：Springboot（JAVA）

## 3. 项目阶段

### 3.1. 项目选题

按照老师的要求，该项目需要两份前端的工程（移动端和PC端），一份后端的工程；而我们的选题是【宠物信息交流平台】

### 3.2. 需求分析

在这个阶段，我们先通过竞品分析，了解了【宠物信息交流平台】的案例网站，以下为主要参考网站

[全国宠友互助社区 - 免费宠物领养*寻猫启示*寻狗启事\_犬猫配种宠物平台](https://www.chongyoushe.com/)

[爱宠网 - 有爱有趣有用的宠物门户网站！](https://www.lovepet.cn/)

经过一番研究之后，我们大概了解了该类网站的业务逻辑：PC端负责展示帖子的信息，而发布帖子的功能是在移动端通过微信小程序的形式进行使用（发布帖子的时候网站需要用户扫描二维码）

尽管我们分析的竞品是这种业务逻辑，我们小组在讨论之后则打算采用另外一种方案，即在移动端实现用户操作的所有功能（包括发布帖子），在PC端做一个管理员后台。

当然，这和老师给我们的解释也有关系；因为短学期的项目目的是使尽可能多的同学参与开发当中。因此，要是PC端和移动端的功能耦合程度大，无论是对于开发难度还是用户使用体验程度而言都是不适合的。

### 3.3. 方案设计

本阶段，是原型的设计阶段；为了能够推动项目的快速进展，我们在画原型的时候采用了笔绘，省去了使用原型工具时对于样式的过度纠结，专注于设计各个界面如何对各种数据进行展示。

> 移动端的原型设计（笔绘版）

![发表帖子界面](https://prod-files-secure.s3.us-west-2.amazonaws.com/120bd56a-ca1a-44ba-bfb9-f475c03d33ed/fdf3b2f2-f556-45da-836a-e4dc8594d39c/%E5%8F%91%E8%A1%A8%E5%B8%96%E5%AD%90.jpeg)

发表帖子界面

![个人动态界面](https://prod-files-secure.s3.us-west-2.amazonaws.com/120bd56a-ca1a-44ba-bfb9-f475c03d33ed/32da0fec-2d0f-4009-9eeb-758844df01e6/%E4%B8%AA%E4%BA%BA%E5%8A%A8%E6%80%81.jpg)

个人动态界面

![社区主页界面](https://prod-files-secure.s3.us-west-2.amazonaws.com/120bd56a-ca1a-44ba-bfb9-f475c03d33ed/43f2a92c-26de-4d5b-87a4-40b04ad30c87/%E7%A4%BE%E5%8C%BA%E4%B8%BB%E9%A1%B5.jpg)

社区主页界面

![帖子详情界面](https://prod-files-secure.s3.us-west-2.amazonaws.com/120bd56a-ca1a-44ba-bfb9-f475c03d33ed/00a3ffbb-bc4f-4802-b071-e8a8ca89a195/%E5%B8%96%E5%AD%90%E8%AF%A6%E6%83%85.jpeg)

帖子详情界面

![用户登录界面](https://prod-files-secure.s3.us-west-2.amazonaws.com/120bd56a-ca1a-44ba-bfb9-f475c03d33ed/0f0507ac-74f3-49a8-b7be-af0e7e059a16/%E7%94%A8%E6%88%B7%E7%99%BB%E5%BD%95.jpg)

用户登录界面

当然，笔绘版本的原型设计稿出来之后，我们的项目经理为我们完成了Axure的原型设计

### 3.4. 详细设计

> API文档的导出

[新API文档.pdf](https://prod-files-secure.s3.us-west-2.amazonaws.com/120bd56a-ca1a-44ba-bfb9-f475c03d33ed/10a0c10e-8348-4e1e-bff2-fc8ade28bc19/%E6%96%B0API%E6%96%87%E6%A1%A3.pdf)

在原型确定下来之后，前端需要的数据项也就明确了，于是我们就开始了API的设计；于此同时，我们小组成立了飞书的组织，因为我认为使用云文档进行API文档的书写能够提高团队的沟通效率：团队中的所有成员能够实时对文档中变化的内容进行查看并且进行修改（除了短学期的上课时间，我们团队中的成员大部分时间是分开办公的，因此在开发过程中如果对某些数据项或返回信息的要求有变更，就能够通过API云文档进行即时的修改与反馈）

### 3.5. 代码开发

API的规范定好之后，我就开始了前端界面代码的编写。对我来说，这个阶段是整个项目中耗时最长的；其中不仅包括了UI样式布局的分配（Vuetify提供style api其实帮了很多忙，大部分情况下不用手搓css），还有涉及到UX的操作逻辑和数据的动态响应和DOM的动态渲染等，大致算下来使用了6天时间来完成了大部分前端代码的编写。

在此过程中，我使用的是【模拟数据】和【Postman】的【Mock Server】进行单元测试。

### 3.6. 集成测试

这是最痛苦的一个阶段，但同时也是整个项目正式成型的阶段。通过连接后端的服务器，我们对数据的拿取做到了动态的响应；于此同时，我们也发现了之前API设计的某些缺陷和不足，进行了修改。最重要的是我们对程序进行了debug，发现了许多漏洞，并及时地进行了更改。

在确定程序基本没有问题之后，小组的其它成员下载了我的代码，并连接后端服务器进行了最终展示数据的录入。

### 3.7. 系统实施

项目的最终验收。在演示的过程中，老师针对项目的不同模块给出了相应的改善建议。

## 4. 项目亮点

- 在显示详情信息时，应用会根据帖子的不同类型进行相应的图标映射，提升了用户的使用体验
- 在不同界面展示帖子使用了不同的布局
  - 社区界面：用户可见范围内只有一张显示帖子的卡片，可以提高用户刷帖子的沉浸式体验
  - 个人动态：在屏幕视口宽度的范围内展示两张帖子的卡片，方便用户进行帖子的管理
  - 宠物画廊：以九宫格的形式进行呈现，顾名思义”画廊“
- 通过无限滚动，进行社区界面中帖子展示的分页，优化了系统性能

## 5. 遇到的困难 & 解决方法 & 学到的经验

### 5.1. 移动端的UI/UX设计

由于我之前做的项目都是适配PC端的，也没有做响应式设计；因此，这次的项目是我第一次做适配移动端的web app。尽管移动端和PC端的web app使用的前端技术栈基本相同（做的不是原生app），这两者的UI/UX上还是有很大区别的。

考虑到PC端有较大的屏幕宽度，页面信息基本能够以平摊的方式来展示出来，使用滚动条的频率也相对小；而对于屏幕宽度窄，高度长的移动端设备来说，要尽可能充分利用此特点的方式就是增加用户划动界面的频率（即PC端的滚动条）。

这里就涉及到了移动端界面的无限滚动功能。一开始我认为该功能实现困难，因为也许需要涉及使用队列来进行帖子DOM的动态变化（在往下刷帖子的时候，上面刷过的帖子要消失）

但是事实证明，我的担心来自我对于移动端交互实现的不熟悉。与PC端的分页功能不同（每次点击下一页的时候展示当前一整页的内容，而不展示前一页的内容）；对于移动端，在获取下一个分页的内容之后，前一个分页的内容还是存在的，并不需要移除。而Vuetify中也是提供了无限滚动的控件，只需要定义当用户划到页面底端时触发的函数即可。

除此之外，与PC端的顶部导航栏不同的是，大多数移动端应用的导航栏位于屏幕底部。

---

> 参考界面的截图（帖子）

![Instagram](https://prod-files-secure.s3.us-west-2.amazonaws.com/120bd56a-ca1a-44ba-bfb9-f475c03d33ed/ac628976-34e6-4cff-bb3e-a9374d1ef1ee/ins.jpg)

Instagram

![闲鱼](https://prod-files-secure.s3.us-west-2.amazonaws.com/120bd56a-ca1a-44ba-bfb9-f475c03d33ed/1c047e47-edf1-4387-8241-07e5a5e42a89/%E9%97%B2%E9%B1%BC.jpg)

闲鱼

![小红书](https://prod-files-secure.s3.us-west-2.amazonaws.com/120bd56a-ca1a-44ba-bfb9-f475c03d33ed/15bdca6e-8f93-4521-bec9-b1f85f1f249a/%E5%B0%8F%E7%BA%A2%E4%B9%A6.jpg)

小红书

在对此类界面的原型设计过程中，我参考了当前主流社交app界面的交互方式。研究之后，我发现大部分帖子是使用了【卡片】这一控件对内容进行展示，并且图片的占比较大。相应的，在Vuetify中，就需要使用Card与Carousel控件相结合。

---

> 参考界面的截图（输入）

![Instagram](https://prod-files-secure.s3.us-west-2.amazonaws.com/120bd56a-ca1a-44ba-bfb9-f475c03d33ed/257e4aaf-8795-43fe-affd-6b706f0e13c8/ins1.jpg)

Instagram

![闲鱼](https://prod-files-secure.s3.us-west-2.amazonaws.com/120bd56a-ca1a-44ba-bfb9-f475c03d33ed/de47c075-eb49-431c-8c29-9eced0ad2b14/%E9%97%B2%E9%B1%BC1.jpg)

闲鱼

![小红书](https://prod-files-secure.s3.us-west-2.amazonaws.com/120bd56a-ca1a-44ba-bfb9-f475c03d33ed/1b1f0513-a258-42c0-aa50-74d0427c966e/%E5%B0%8F%E7%BA%A2%E4%B9%A61.jpg)

小红书

对于类表单输入的控件，则是大多数使用弹窗的形式使用户进行输入内容，与PC端的表单控件相比就更为复杂。要解决该功能，就需要添加更多的响应式变量。相应的，在Vue3中，就需要使用更多的ref/reactive或computed钩子来与html元素进行绑定Vuetify中的Sheet控件的可见性与数据保存。

### 5.2. 遇到的Bugs

在集成测试阶段，我们使用不同用户进行登录登出的时候遇到了会登进错误用户账号的情况；经过分析，我发现了是由于我将一个动态的axios config参数（把jwt令牌放进请求的headers中）存入了环境变量中进行引用来使用，导致每次从config文件中get到的Cookie都是之前留存在浏览器中的，无法即时更新，导致此Bug的出现。

```jsx
import Cookies from "js-cookie";
const config = { headers: { token: Cookies.get("userToken") } };
export default config;
```

```jsx
import config from "@/CONST/config";

const postsRes = await axios.get(`${baseURL}/posts?uid=${uid}`, {
  config,
});
```

---

对于此问题，解决方法就是少偷点懒，在每次发送axios请求的时候都手动多写一个`config`的参数，在现场调用 `Cookies.get(’userToken’)` 方法，就不会出现该bug了。

```jsx
// import config from "@/CONST/config";

const postsRes = await axios.get(`${baseURL}/posts?uid=${uid}`, {
  headers: { token: Cookies.get("userToken") },
});
```

---

除此之外，还遇到了很多小bug，出现错误的原因有如下这些情况：

> `cannot read properties of null`

- 解决方法：使用可选链运算符 ?.

```jsx
<Title :title="postInfo.reactiveData?.title"></Title>
```

> `defineEmits`的数据出错

- 解决方法：需要对变量进行解构

```jsx
const { isMyProfile } = defineProps(["is-my-profile"]);
```

> 响应式数据读取值失败

- 解决方法：
  - 在`<script setup></script>`中，对于`ref`数据需要对`.value`进行读取，对于`reactive`数据则直接读取
  - 在`<template></template>`中使用`ref`和`reactive`数据皆直接使用即可

```jsx
import { ref, reactive } from "vue";

let curView = ref(0);
const var = curView.value;

let postInfo = reactive({ reactiveData: null });
const username = postInfo.reactiveData?.username;
```

## 6. 项目结果

在最后的系统实施阶段，我们基本完成了预期中的所有功能。但是由于开发时间的原因，有一些功能没有完善的特别好。例如无限滚动的分页功能；此功能在社区主页中得到了实施，但是由于时间不足，没能够在帖子详情中的评论区模块中应用到。但是考虑到此功能在类似的模块中已经得到实现，证明了我已经掌握了该技术的实现方法；如果在时间充分的情况下，是能够将此技术投放到其它模块中的。

对于系统稳定性而言，经过验收前的测试，本系统的鲁棒性还是较为可观的。在移动端，经过注册和登录，用户能够对帖子和评论进行新增、查看和删除；在PC端，管理员可以对帖子和评论进行审查，并且能够封禁不符合系统使用规范的帖子、评论和用户。

对于不符合规范的输入，系统具有良好的表单验证功能，可以防止用户发表不符合数据规范的帖子、评论和注册表单；对于请求的发送和接收，也对请求失败的情况进行了处理，防止系统的异常崩溃。

## 7. 未来可实施的改进

### 7.1. 图片存储格式

由于本次项目我第一次接触到图片的存储，对这方面的了解不是很多。总之，我们在本项目中选择了base64作为图片的存储和传输格式，导致每次帖子的加载时间都很长，严重降低了系统的性能。

根据老师的建议，我们应当使用url的形式来对图像进行存储，这样能够大大减小每次响应包的大小，从而提升数据加载的速度。

### 7.2. 移动端的检索和分类功能

按照帖子类型搜索的API在设计的时候有考虑到，并且在PC端也有相应的实现。但是在本项目周期中，没有充足的时间在移动端实现该功能；因此，模糊查询帖子标题、用户，以及对帖子类型进行分类的功能可以作为本项目在未来版本升级中引进的新功能。

### 7.3. 点赞的用户追踪

对于目前项目的点赞功能，本系统无法对于点赞进行用户的追踪，导致用户能对相同的帖子进行多次的点赞，而这点是明显不符合业务逻辑的。但是此功能可以作为系统的未来改进实施。

### 7.4. UI/UX的完善

尽管移动端的UI界面大致符合了用户在手机上所期待的视图，界面仍有美化的空间。除此之外，UX体验也能够进行升级。例如：在当前系统中，用户需要通过长按来对评论进行删除；对此，老师建议能够对每个评论添加一个Swipe事件的监听器，使用户能够通过滑动评论进行删除。

由于这是我做的第一个适配移动端的界面，有一些设计的不足也是在意料之中；相信通过往后更多项目的历练，能够使我在设计移动端UI/UX时考虑得更加全面。

## 8. 个人成长

- 增加了对Vue3使用的熟练度
- 进一步了解了响应式DOM渲染组件的生命周期和运行原理
- 对移动端应用的UI/UX进行过了深入的研究，积累了相关经验
- 传输数据量的增加使我理解了系统性能优化的必要性
- 团队合作开发使我意识到使用Github能够方便组员进行代码的查看、克隆与管理
